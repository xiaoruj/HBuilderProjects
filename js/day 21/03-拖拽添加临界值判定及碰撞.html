<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<style>
			*{
				margin: 0;
				padding: 0;
			}
			#box{
				position: absolute;
				left: 0;
				top: 0;
				width: 150px;
				height: 100px;
				background-color: red;
			}
			img{
				position: absolute;
				left: 0;
				top: 0;
				bottom: 0;
				right: 0;
				margin: auto;
				width: 200px;
				height: 100px;
			}
			
		</style>
	</head>
	<body>
		<div id="box">
			尚硅谷
		</div>
		<img src="img/17.jpg" alt="" />
		<script type="text/javascript">
			window.onload = function(){
				var box = document.getElementById('box')
				var imgNode = document.querySelector('img');
				box.onmousedown = function(event){
					event = event || window.event;
					var eleX = box.offsetLeft;
					var eleY = box.offsetTop;
					var startX = event.clientX;
					var startY = event.clientY;
					box.setCapture && box.setCapture();
					document.onmousemove = function(event){
						event = event || window.event;
						var endX = event.clientX;
						var endY = event.clientY;
						var disX = endX - startX;
						var disY = endY - startY;
						var lastX = eleX + disX;
						var lastY = eleY + disY;
						if(lastX > document.documentElement.clientWidth - box.offsetWidth - 50){
							lastX = document.documentElement.clientWidth - box.offsetWidth;
						}else if(lastX < 50){
							lastX = 0;
						}
						
						if(lastY > document.documentElement.clientHeight - box.offsetHeight - 50){
							lastY = document.documentElement.clientHeight - box.offsetHeight;
						}else if(lastY < 50){
							lastY = 0;
						}
						box.style.left = lastX + 'px';
						box.style.top = lastY + 'px';
						var boxL = lastX + box.offsetWidth;
						var imgL = imgNode.getBoundingClientRect().left;
						var boxT = lastY + box.offsetHeight;
						var imgT = imgNode.getBoundingClientRect().top;
						var boxR = lastX;
						var imgR = imgNode.getBoundingClientRect().left + imgNode.offsetWidth;
						var boxB = lastY;
						var imgB = imgNode.getBoundingClientRect().top + imgNode.offsetHeight;
						if(boxL < imgL || boxT < imgT || boxR > imgR  || boxB > imgB){
							imgNode.src = 'img/17.jpg';
						}else{
							imgNode.src = 'img/3.jpg';
						}
						
					};
					document.onmouseup = function(){
						document.onmousemove = document.onmouseup = null;
						box.releaseCapture && box.releaseCapture();
					}
					return false;
				}
			}
		</script>
	</body>
</html>
